<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs"
     xmlns:ui="http://wixtoolset.org/schemas/v4/wxs/ui" >
  <Package Name="TrinoODBC 32-bit and 64-bit"
           Language="1033"
           Version="0.0.1"
           Manufacturer="Trino"
           UpgradeCode="F36E626E-4634-4409-864B-C04776466570"
           InstallerVersion="500"
           Compressed="yes"
           Scope="perMachine">
    <MajorUpgrade AllowSameVersionUpgrades="yes"
                  DowngradeErrorMessage="A newer version of the TrinoODBC driver is already installed"/>
    <WixVariable Id="WixUILicenseRtf" Value="LICENSE.rtf" />
    <ui:WixUI Id="WixUI_Minimal" InstallDirectory="INSTALLFOLDER"/>

    <Media Id="1" Cabinet="product.cab" EmbedCab="yes" />

    <StandardDirectory Id="SystemFolder">
      <Directory Id="INSTALLFOLDER" Name="TrinoODBC">
        <Component Id="DriverDLL" Guid="467DF431-AA83-4CCA-95DD-490F3E8CFBD7">
          <File Id="TrinoODBCx86" Name="TrinoODBC.dll" Source="..\\out\\build\\x86-release\\TrinoODBC.dll" KeyPath="yes" />
          <File Id="libcurl_x86" Name="libcurl.dll" Source="..\\out\\build\\x86-release\\libcurl.dll" />
          <File Id="zlib1_x86" Name="zlib1.dll" Source="..\\out\\build\\x86-release\\zlib1.dll" />
          <File Id="libssl_x86" Name="libssl-3.dll" Source="..\\out\\build\\x86-release\\libssl-3.dll" />
          <File Id="libcrypto_x86" Name="libcrypto-3.dll" Source="..\\out\\build\\x86-release\\libcrypto-3.dll" />
          <File Id="third_party_licenses_x86" Name="third_party_licenses.txt" Source=".\\third_party_licenses.txt" />
          <RegistryKey Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\ODBC Drivers">
            <RegistryValue Name="TrinoODBC" Type="string" Value="Installed" />
          </RegistryKey>
          <RegistryKey Root="HKLM" Key="SOFTWARE\WOW6432Node\ODBC\ODBCINST.INI\TrinoODBC">
            <RegistryValue Name="APILevel" Type="string" Value="0" />
            <RegistryValue Name="Driver" Type="string" Value="[SystemFolder]TrinoODBC\TrinoODBC.dll" />
            <RegistryValue Name="Setup" Type="string" Value="[SystemFolder]TrinoODBC\TrinoODBC.dll" />
            <RegistryValue Name="DriverODBCVer" Type="string" Value="03.80" />
            <RegistryValue Name="ConnectFunctions" Type="string" Value="YYN" />
            <RegistryValue Name="FileUsage" Type="string" Value="0" />
            <RegistryValue Name="SQLLevel" Type="string" Value="0" />
          </RegistryKey>
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="System64Folder">
      <Directory Id="INSTALLFOLDER64" Name="TrinoODBC">
        <Component Id="DriverDLL64" Guid="C0EA1A75-7155-484F-83A8-A2CC7B91CAA2">
          <File Id="TrinoODBCx64" Name="TrinoODBC.dll" Source="..\\out\\build\\x64-release\\TrinoODBC.dll" KeyPath="yes" />
          <File Id="libcurl_x64" Name="libcurl.dll" Source="..\\out\\build\\x64-release\\libcurl.dll" />
          <File Id="zlib1_x64" Name="zlib1.dll" Source="..\\out\\build\\x64-release\\zlib1.dll" />
          <File Id="libssl_x64" Name="libssl-3-x64.dll" Source="..\\out\\build\\x64-release\\libssl-3-x64.dll" />
          <File Id="libcrypto_x64" Name="libcrypto-3-x64.dll" Source="..\\out\\build\\x64-release\\libcrypto-3-x64.dll" />
          <File Id="third_party_licenses_x64" Name="third_party_licenses.txt" Source=".\\third_party_licenses.txt" />
          <RegistryKey Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\ODBC Drivers">
            <RegistryValue Name="TrinoODBC" Type="string" Value="Installed" />
          </RegistryKey>
          <RegistryKey Root="HKLM" Key="SOFTWARE\ODBC\ODBCINST.INI\TrinoODBC">
            <RegistryValue Name="APILevel" Type="string" Value="0" />
            <RegistryValue Name="Driver" Type="string" Value="[System64Folder]TrinoODBC\TrinoODBC.dll" />
            <RegistryValue Name="Setup" Type="string" Value="[System64Folder]TrinoODBC\TrinoODBC.dll" />
            <RegistryValue Name="DriverODBCVer" Type="string" Value="03.80" />
            <RegistryValue Name="ConnectFunctions" Type="string" Value="YYN" />
            <RegistryValue Name="FileUsage" Type="string" Value="0" />
            <RegistryValue Name="SQLLevel" Type="string" Value="0" />
          </RegistryKey>
        </Component>
      </Directory>
    </StandardDirectory>

    <Feature Id="TrinoODBC32Bit" Title="32-bit Trino ODBC Driver" Level="1">
      <ComponentRef Id="DriverDLL" />
    </Feature>
    <Feature Id="TrinoODBC64Bit" Title="64-bit Trino ODBC Driver" Level="1">
      <ComponentRef Id="DriverDLL64" />
    </Feature>

  </Package>
</Wix>
